<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="pandas,可视化," />





  <link rel="alternate" href="/atom.xml" title="尤尔小屋" type="application/atom+xml" />






<meta name="description" content="pandas系列10-数值操作2 本文是书《对比Excel，轻松学习Python数据分析》的第二篇，主要内容包含  区间切分 插入数据（行或列） 转置 索引重塑 长宽表转换">
<meta name="keywords" content="pandas,可视化">
<meta property="og:type" content="article">
<meta property="og:title" content="pandas系列11-cut&#x2F;stack&#x2F;melt">
<meta property="og:url" content="http:&#x2F;&#x2F;www.renpeter.cn&#x2F;2020&#x2F;06&#x2F;21&#x2F;pandas%E7%B3%BB%E5%88%9711-cut-stack-melt.html">
<meta property="og:site_name" content="尤尔小屋">
<meta property="og:description" content="pandas系列10-数值操作2 本文是书《对比Excel，轻松学习Python数据分析》的第二篇，主要内容包含  区间切分 插入数据（行或列） 转置 索引重塑 长宽表转换">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzn04nzvvj30pa0oadhh.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfznlsxahuj30x90u0gnh.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfznv84hgpj31760dywh0.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzo1dttgaj315u0s4jv4.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzo75nzgzj31360f6mzi.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzojjibtvj317v0u0wky.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzopj3ws5j31ls0kq79j.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzotdzam2j30o20kwq6x.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzoxhih32j30s010owho.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzp2dwwttj30r20iktal.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzp4jo4y8j30vy0l0te0.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzp74bl2pj317w0eyjsg.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzp9yv2txj31120s241i.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzpguvxjbj30dg03qaa2.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzpkelyeuj309s07sq31.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzpps46ihj30l610etc1.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzprnqs5sj30kq0i0myl.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzq5k6tgnj30ly03xgmi.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzq5z4zkoj30lw0c7mzt.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzqkw0345j30x00u0af3.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzqlhn88aj312w0m8gp5.jpg">
<meta property="og:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzqpp87xwj30ud0u0tdm.jpg">
<meta property="og:updated_time" content="2020-06-21T03:25:20.972Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https:&#x2F;&#x2F;tva1.sinaimg.cn&#x2F;large&#x2F;007S8ZIlgy1gfzn04nzvvj30pa0oadhh.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    },
    
    emojis: {
      className: 'github-emoji'
    }
  };
</script>



  <link rel="canonical" href="http://www.renpeter.cn/2020/06/21/pandas系列11-cut-stack-melt.html"/>





  <title>pandas系列11-cut/stack/melt | 尤尔小屋</title>
  








</head>


<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

   <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <a href="https://github.com/pidada" target="_blank" rel="noopener"><img style="position: absolute; top: 0; right: 0; border: 0" width="149" height="149" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_white_ffffff.png?resize=149%2C149" class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>
    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">尤尔小屋</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">Stay Foolish Stay Hungry</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            Categories
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            About
          </a>
        </li>
      
        
        <li class="menu-item menu-item-links">
          <a href="/links/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-link"></i> <br />
            
            links
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://www.renpeter.cn/2020/06/21/pandas%E7%B3%BB%E5%88%9711-cut-stack-melt.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="PiQianChao">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/cunshang.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="尤尔小屋">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">pandas系列11-cut/stack/melt</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2020-06-21T11:24:19+08:00">
                2020-6-21
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">In</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/pandas/" itemprop="url" rel="index">
                    <span itemprop="name">pandas</span>
                  </a>
                </span>

                
                
                  , 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/pandas/%E6%96%87%E6%A1%A3/" itemprop="url" rel="index">
                    <span itemprop="name">文档</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2020/06/21/pandas%E7%B3%BB%E5%88%9711-cut-stack-melt.html#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count"
                        data-disqus-identifier="2020/06/21/pandas系列11-cut-stack-melt.html" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Words count in article&#58;</span>
                
                <span title="Words count in article">
                  1.1k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">Reading time &asymp;</span>
                
                <span title="Reading time">
                  4
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h3 id="pandas系列10-数值操作2">pandas系列10-数值操作2</h3>
<p>本文是书《<strong>对比Excel，轻松学习Python数据分析</strong>》的第二篇，主要内容包含</p>
<ul>
<li>区间切分</li>
<li>插入数据（行或列）</li>
<li>转置</li>
<li>索引重塑</li>
<li>长宽表转换</li>
</ul>
<a id="more"></a>
<h3 id="区间切分">区间切分</h3>
<h4 id="Excel">Excel</h4>
<p>Excel中区间切分使用的是if函数</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">=IF(A2&lt;<span class="number">4</span>,<span class="string">"&lt;4"</span>,IF(A2&lt;<span class="number">7</span>,<span class="string">"4-6"</span>,<span class="string">"&gt;=7"</span>))</span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzn04nzvvj30pa0oadhh.jpg" alt=""></p>
<h4 id="python">python</h4>
<h5 id="栗子">栗子</h5>
<p><code>Pandas</code>中进行区间切分使用的是<code>cut()</code>方法，方法中有个<code>bins</code>参数来指明区间</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfznlsxahuj30x90u0gnh.jpg" alt=""></p>
<h5 id="cut">cut()</h5>
<p>下面看看官网上对cut函数的详解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pandas.cut(x, bins, right: bool = <span class="literal">True</span>, labels=<span class="literal">None</span>, retbins: bool = <span class="literal">False</span>,</span><br><span class="line">           precision: int = <span class="number">3</span>, include_lowest: bool = <span class="literal">False</span>, duplicates: str = <span class="string">'raise'</span>)</span><br></pre></td></tr></table></figure>
<ul>
<li>
<p>x：The input array to be binned. Must be 1-dimensional.待切分的数据，必须是一维的</p>
</li>
<li>
<p>bins：int, sequence of scalars, or IntervalIndex（间隔指数）.The criteria to bin by：指定切分的区间，有3种标准</p>
<ul>
<li>int : Defines the number of equal-width bins in the range of x. The range of x is extended by .1% on each side to include the minimum and maximum values of x.</li>
<li>sequence of scalars : Defines the bin edges allowing for non-uniform width. No extension of the range of x is done.</li>
<li>IntervalIndex : Defines the exact bins to be used. Note that IntervalIndex for bins must be non-overlapping.</li>
</ul>
</li>
<li>
<p><strong>right</strong>：bool, default True：切分的时候保持左开右闭，右边是关闭状态（默认）</p>
<p>Indicates whether bins includes the rightmost edge or not. If <code>right == True</code> (the default), then the bins <code>[1, 2, 3, 4]</code> indicate (1,2], (2,3], (3,4]. This argument is ignored when bins is an IntervalIndex.</p>
</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfznv84hgpj31760dywh0.jpg" alt=""></p>
<ul>
<li>
<p><strong>labels</strong>：array or False, default None：将分割好的区间用标签来代替</p>
<p>Specifies the labels for the returned bins. Must be the same length as the resulting bins. If False, returns only integer indicators of the bins. This affects the type of the output container (see below). This argument is ignored when bins is an IntervalIndex. If True, raises an error.</p>
</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzo1dttgaj315u0s4jv4.jpg" alt=""></p>
<ul>
<li>
<p><strong>retbins</strong>：bool, default False：是否返回bins</p>
<p>Whether to return the bins or not. Useful when bins is provided as a scalar.</p>
</li>
</ul>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzo75nzgzj31360f6mzi.jpg" alt=""></p>
<h5 id="qcut">qcut</h5>
<p>不需要事先指明切分区间，只需要指明切分的份数即可，依据的原则是每个份数中的数据尽可能相等</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzojjibtvj317v0u0wky.jpg" alt=""></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzopj3ws5j31ls0kq79j.jpg" alt=""></p>
<h3 id="插入新行或列">插入新行或列</h3>
<h4 id="Excel-v2">Excel</h4>
<p>Excel直接在确定要加入的某行或者列的前面，在菜单栏中选择加入即可</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzotdzam2j30o20kwq6x.jpg" alt=""></p>
<h4 id="Python">Python</h4>
<p>Python中通过insert方法实现：指明要插入的位置、插入后新列的列名、以及要插入的数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">df.insert(<span class="number">2</span>,<span class="string">"score"</span>,np.random.randint(<span class="number">80</span>,<span class="number">100</span>,<span class="number">10</span>))  <span class="comment"># 第2列之后插入名为score的一列数据</span></span><br></pre></td></tr></table></figure>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzoxhih32j30s010owho.jpg" alt=""></p>
<p>pandas中还可以通过直接给某列字段赋值的方式实现</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzp2dwwttj30r20iktal.jpg" alt=""></p>
<h3 id="行列互换">行列互换</h3>
<p>行列互换实际上就是<strong>转置</strong>的意思</p>
<h4 id="excel">excel</h4>
<ol>
<li>现将要转换的数据进行复制</li>
<li>在粘贴的时候勾选$\color{red}{选择性粘贴}$，再选择转置即可</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzp4jo4y8j30vy0l0te0.jpg" alt=""></p>
<p>转置后的效果图</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzp74bl2pj317w0eyjsg.jpg" alt=""></p>
<h4 id="Python-v2">Python</h4>
<p>pandas中的转置只需要调用<code>.T</code>方法即可</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzp9yv2txj31120s241i.jpg" alt=""></p>
<h3 id="索引重塑">索引重塑</h3>
<p>所谓的索引重塑就是将原来的索引重新进行构造。两种常见的表示数据的结构：</p>
<ul>
<li>表格型</li>
<li>树形</li>
</ul>
<ol>
<li>下面👇是表格型的示意图，通过一个行坐标和列坐标来确定一个数据</li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzpguvxjbj30dg03qaa2.jpg" alt=""></p>
<ol start="2">
<li>下面👇是树形的结构示意图：将原来表格型的列索引也变成了行索引，其实就是<strong>给表格型数据建立层次化索引</strong></li>
</ol>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzpkelyeuj309s07sq31.jpg" alt="image-20200621103653722"></p>
<p><strong>把数据从表格型数据转换到树形数据的过程，称之为重塑reshape</strong></p>
<h4 id="stack">stack</h4>
<p>该过程在<code>Excel</code>中无法实现，在<code>pandas</code>中是通过$\color{red}{stack}$方法实现的</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzpps46ihj30l610etc1.jpg" alt="image-20200621104205419"></p>
<h4 id="unstack">unstack</h4>
<p>将树形数据转成表格型数据</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzprnqs5sj30kq0i0myl.jpg" alt=""></p>
<h3 id="长宽表转换">长宽表转换</h3>
<h4 id="长表和宽表">长表和宽表</h4>
<p><strong>长表：很多行记录</strong></p>
<p><strong>宽表：属性特别多</strong></p>
<p>Excel中的长宽表转换是直接通过复制和粘贴实现的。Python中的实现是通过<code>stack()</code>和<code>melt()</code>方法。在转换的过程中，<strong>宽表和长表中必须要有相同的列</strong>。比如将下图的宽表转成长表</p>
<p>宽表：</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzq5k6tgnj30ly03xgmi.jpg" alt=""></p>
<p>长表：</p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzq5z4zkoj30lw0c7mzt.jpg" alt=""></p>
<h4 id="实现过程">实现过程</h4>
<h5 id="stack方法">stack方法</h5>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzqkw0345j30x00u0af3.jpg" alt=""></p>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzqlhn88aj312w0m8gp5.jpg" alt=""></p>
<h5 id="melt">melt()</h5>
<p>主要参数及解释</p>
<table>
<thead>
<tr>
<th style="text-align:left">Name</th>
<th style="text-align:left">Description</th>
<th style="text-align:left">Type/Default Value</th>
<th style="text-align:left">Required / Optional</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">frame</td>
<td style="text-align:left"></td>
<td style="text-align:left">DataFrame</td>
<td style="text-align:left">Required</td>
</tr>
<tr>
<td style="text-align:left">id_vars</td>
<td style="text-align:left">Column(s) to use as identifier variables.</td>
<td style="text-align:left">tuple, list, or ndarray</td>
<td style="text-align:left">Optional</td>
</tr>
<tr>
<td style="text-align:left">value_vars</td>
<td style="text-align:left">Column(s) to unpivot. If not specified, uses all columns that are not set as id_vars.</td>
<td style="text-align:left">tuple, list, or ndarray</td>
<td style="text-align:left">Optional</td>
</tr>
<tr>
<td style="text-align:left">var_name</td>
<td style="text-align:left">Name to use for the ‘variable’ column. If None it uses <a href="http://frame.columns.name" target="_blank" rel="noopener">frame.columns.name</a> or ‘variable’.</td>
<td style="text-align:left">scalar</td>
<td style="text-align:left">Required</td>
</tr>
<tr>
<td style="text-align:left">value_name</td>
<td style="text-align:left">Name to use for the ‘value’ column.</td>
<td style="text-align:left">scalar Default Value: ‘value’</td>
<td style="text-align:left">Required</td>
</tr>
<tr>
<td style="text-align:left">col_level</td>
<td style="text-align:left">If columns are a MultiIndex then use this level to melt.</td>
<td style="text-align:left">int or string</td>
<td style="text-align:left">Optional</td>
</tr>
</tbody>
</table>
<p><img src="https://tva1.sinaimg.cn/large/007S8ZIlgy1gfzqpp87xwj30ud0u0tdm.jpg" alt="image-20200621111636774"></p>
<ul>
<li>company和name是行索引</li>
<li>Year是列属性</li>
<li>Sale是值</li>
</ul>

      
    </div>
    
    
    

<div>
      
        
<div class="my_post_copyright">
  <script src="//cdn.bootcss.com/clipboard.js/1.5.10/clipboard.min.js"></script>
  
  <!-- JS库 sweetalert 可修改路径 -->
  <script src="https://cdn.bootcss.com/jquery/2.0.0/jquery.min.js"></script>
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
  <p><span>本文标题:</span><a href="/2020/06/21/pandas%E7%B3%BB%E5%88%9711-cut-stack-melt.html">pandas系列11-cut/stack/melt</a></p>
  <p><span>发布时间:</span>2020年06月21日 - 11:06</p>
  <p><span>原始链接:</span><a href="/2020/06/21/pandas%E7%B3%BB%E5%88%9711-cut-stack-melt.html" title="pandas系列11-cut/stack/melt">http://www.renpeter.cn/2020/06/21/pandas%E7%B3%BB%E5%88%9711-cut-stack-melt.html</a>
    <span class="copy-path"  title="点击复制文章链接"><i class="fa fa-clipboard" data-clipboard-text="http://www.renpeter.cn/2020/06/21/pandas%E7%B3%BB%E5%88%9711-cut-stack-melt.html"  aria-label="复制成功！"></i></span>
  </p>
  <p><span>许可协议:</span><i class="fa fa-creative-commons"></i> <a rel="license" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank" title="Attribution-NonCommercial-NoDerivatives 4.0 International (CC BY-NC-ND 4.0)">署名-非商业性使用-禁止演绎 4.0 国际</a> 转载请保留原文链接及作者。</p>  
</div>
<script> 
    var clipboard = new Clipboard('.fa-clipboard');
	  $(".fa-clipboard").click(function(){
      clipboard.on('success', function(){
        swal({   
          title: "",   
          text: '复制成功',
          icon: "success", 
          showConfirmButton: true
          });
	    });
    });  
</script>

      
</div>


    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>Coffee or Tea</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>Donate</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="/images/wechatpay.jpg" alt="PiQianChao WeChat Pay"/>
        <p>WeChat Pay</p>
      </div>
    

    

    

  </div>
</div>

      </div>
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/pandas/" rel="tag"># pandas</a>
          
            <a href="/tags/%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag"># 可视化</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2020/06/16/Sklearn%E5%BA%93%E4%B8%AD%E4%BD%BF%E7%94%A8PCA.html" rel="next" title="Sklearn库中使用PCA">
                <i class="fa fa-chevron-left"></i> Sklearn库中使用PCA
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2020/06/21/3%E5%A4%A7%E5%88%A9%E5%99%A8%E8%AF%A6%E8%A7%A3-map-apply-applymap.html" rel="prev" title="3大利器详解-map/apply/applymap">
                3大利器详解-map/apply/applymap <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript" target="_blank" rel="noopener">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/images/cunshang.jpg"
                alt="PiQianChao" />
            
              <p class="site-author-name" itemprop="name">PiQianChao</p>
              <p class="site-description motion-element" itemprop="description">My Blog</p>
          </div>
            
           <iframe  frameborder="no" border="0" marginwidth="0" marginheight="0" width=330 height=86 src="//music.163.com/outchain/player?type=2&id=694660&auto=1&height=66"></iframe>
          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">434</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">59</span>
                  <span class="site-state-item-name">categories</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">39</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
                
                  <span class="links-of-author-item">
                    <a href="https://github.com/pidada" target="_blank" title="GitHub">
                      
                        <i class="fa fa-fw fa-github"></i>GitHub</a>
                  </span>
                
                  <span class="links-of-author-item">
                    <a href="mailto:pichaochao1119@gmail.com" target="_blank" title="E-Mail">
                      
                        <i class="fa fa-fw fa-envelope"></i>E-Mail</a>
                  </span>
                
            </div>
          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-3"><a class="nav-link" href="#pandas系列10-数值操作2"><span class="nav-number">1.</span> <span class="nav-text">pandas系列10-数值操作2</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#区间切分"><span class="nav-number">2.</span> <span class="nav-text">区间切分</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Excel"><span class="nav-number">2.1.</span> <span class="nav-text">Excel</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#python"><span class="nav-number">2.2.</span> <span class="nav-text">python</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#栗子"><span class="nav-number">2.2.1.</span> <span class="nav-text">栗子</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#cut"><span class="nav-number">2.2.2.</span> <span class="nav-text">cut()</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#qcut"><span class="nav-number">2.2.3.</span> <span class="nav-text">qcut</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#插入新行或列"><span class="nav-number">3.</span> <span class="nav-text">插入新行或列</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#Excel-v2"><span class="nav-number">3.1.</span> <span class="nav-text">Excel</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Python"><span class="nav-number">3.2.</span> <span class="nav-text">Python</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#行列互换"><span class="nav-number">4.</span> <span class="nav-text">行列互换</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#excel"><span class="nav-number">4.1.</span> <span class="nav-text">excel</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Python-v2"><span class="nav-number">4.2.</span> <span class="nav-text">Python</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#索引重塑"><span class="nav-number">5.</span> <span class="nav-text">索引重塑</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#stack"><span class="nav-number">5.1.</span> <span class="nav-text">stack</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#unstack"><span class="nav-number">5.2.</span> <span class="nav-text">unstack</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#长宽表转换"><span class="nav-number">6.</span> <span class="nav-text">长宽表转换</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#长表和宽表"><span class="nav-number">6.1.</span> <span class="nav-text">长表和宽表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#实现过程"><span class="nav-number">6.2.</span> <span class="nav-text">实现过程</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#stack方法"><span class="nav-number">6.2.1.</span> <span class="nav-text">stack方法</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#melt"><span class="nav-number">6.2.2.</span> <span class="nav-text">melt()</span></a></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

	
	
		<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
		<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
		<div class="widget-wrap">
			<h3 class="widget-title">标签云</h3>
			<div id="myCanvasContainer" class="widget tagcloud">
			<canvas width="250" height="250" id="resCanvas" style="width=100%">
				 <ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hadoop/" rel="tag">Hadoop</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Hive/" rel="tag">Hive</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JJ/" rel="tag">JJ</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Leetcode/" rel="tag">Leetcode</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MySQL/" rel="tag">MySQL</a><span class="tag-list-count">20</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NLP/" rel="tag">NLP</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/TensorFlow/" rel="tag">TensorFlow</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Tool/" rel="tag">Tool</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/d3/" rel="tag">d3</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dash/" rel="tag">dash</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/go/" rel="tag">go</a><span class="tag-list-count">42</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kaggle/" rel="tag">kaggle</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/numpy/" rel="tag">numpy</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pandas/" rel="tag">pandas</a><span class="tag-list-count">43</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/px/" rel="tag">px</a><span class="tag-list-count">23</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pyecharts/" rel="tag">pyecharts</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/" rel="tag">python</a><span class="tag-list-count">35</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spark/" rel="tag">spark</a><span class="tag-list-count">19</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sqlzoo/" rel="tag">sqlzoo</a><span class="tag-list-count">18</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E4%BA%92%E8%81%94%E7%BD%91/" rel="tag">互联网</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8C%BA%E5%9F%9F%E9%93%BE/" rel="tag">区域链</a><span class="tag-list-count">14</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%8F%AF%E8%A7%86%E5%8C%96/" rel="tag">可视化</a><span class="tag-list-count">51</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%90%B4%E6%81%A9%E8%BE%BE/" rel="tag">吴恩达</a><span class="tag-list-count">15</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" rel="tag">大数据</a><span class="tag-list-count">43</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%88%90%E9%95%BF/" rel="tag">成长</a><span class="tag-list-count">12</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a><span class="tag-list-count">52</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/" rel="tag">数据结构</a><span class="tag-list-count">10</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97/" rel="tag">时间序列</a><span class="tag-list-count">5</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" rel="tag">机器学习</a><span class="tag-list-count">54</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B7%B1%E5%9C%B3/" rel="tag">深圳</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%B7%B1%E6%BC%82/" rel="tag">深漂</a><span class="tag-list-count">21</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%9F%E6%B4%BB/" rel="tag">生活</a><span class="tag-list-count">43</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%94%B5%E5%BD%B1/" rel="tag">电影</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%AE%97%E6%B3%95/" rel="tag">算法</a><span class="tag-list-count">11</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E7%BB%8F%E6%B5%8E/" rel="tag">经济</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%87%AA%E6%88%91%E7%AE%A1%E7%90%86/" rel="tag">自我管理</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E8%AE%A1%E7%AE%97%E6%9C%BA/" rel="tag">计算机</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E9%98%85%E8%AF%BB/" rel="tag">阅读</a><span class="tag-list-count">26</span></li></ul>
			</canvas>
			</div>
		</div>
	

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">PiQianChao</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




<div class="theme-info">
  <div class="powered-by"></div>
  <span class="post-count">博客全站共546.5k字</span>
</div>

        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="true"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  

    
      <script id="dsq-count-scr" src="https://pidada.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'http://www.renpeter.cn/2020/06/21/pandas%E7%B3%BB%E5%88%9711-cut-stack-melt.html';
          this.page.identifier = '2020/06/21/pandas系列11-cut-stack-melt.html';
          this.page.title = 'pandas系列11-cut/stack/melt';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://pidada.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  














  





  

  

  

  
  

  
  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      });
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      });
    </script>
    <script type="text/javascript" src="//cdn.bootcss.com/mathjax/2.7.1/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


  
  <script type="text/javascript" src="/js/src/js.cookie.js?v=5.1.4"></script>
  <script type="text/javascript" src="/js/src/scroll-cookie.js?v=5.1.4"></script>


  




<script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>


</body>
</html>
